{% include 'includes/header.html' %}
<div class="container py-4">
  <h1>{{ action }} Usuario</h1>
  <form method="post">
    <div class="row">
      <div class="col-md-6 mb-3">
        <label for="nombres">Nombres</label>
        <input type="text" class="form-control" id="nombres" name="nombres" value="{{ u.nombres if u else '' }}" required>
      </div>
      <div class="col-md-6 mb-3">
        <label for="apellidos">Apellidos</label>
        <input type="text" class="form-control" id="apellidos" name="apellidos" value="{{ u.apellidos if u else '' }}" required>
      </div>
    </div>
    <div class="row">
      <div class="col-md-4 mb-3">
        <label for="nickname">Usuario</label>
        <input type="text" class="form-control" id="nickname" name="nickname" value="{{ u.nickname if u else '' }}" required>
      </div>
      <div class="col-md-4 mb-3">
        <label for="email">Email</label>
        <input type="email" class="form-control" id="email" name="email" value="{{ u.email if u else '' }}" required>
      </div>
      <div class="col-md-4 mb-3">
        <label for="rol">Rol</label>
        <select class="form-select" id="rol" name="rol" required>
          <option value="">Seleccione un rol</option>
          <option value="admin" {{ 'selected' if u and u.rol == 'admin' else '' }}>Administrador</option>
          <option value="supus" {{ 'selected' if u and u.rol == 'supus' else '' }}>Supervisor</option>
        </select>
      </div>
    </div>
    <div class="row">
      <div class="col-md-6 mb-3">
        <label for="password">Contraseña {{ '(dejar en blanco para mantener)' if u else '' }}</label>
        <input type="password" class="form-control" id="password" name="password" {{ 'required' if not u else '' }}>
      </div>
    </div>
    <div class="mb-3">
      <div class="form-check">
        <input type="checkbox" class="form-check-input" id="requiere_cambio_pw" name="requiere_cambio_pw" 
               {{ 'checked' if u and u.requiere_cambio_pw else '' }}>
        <label class="form-check-label" for="requiere_cambio_pw">Requiere cambio de contraseña</label>
      </div>
    </div>
    {% if u %}
    <div class="mb-3">
      <div class="form-check">
        <input type="checkbox" class="form-check-input" id="activo" name="activo" {{ 'checked' if u.activo else '' }}>
        <label class="form-check-label" for="activo">Activo</label>
      </div>
    </div>
    {% endif %}
    <div class="mt-4">
      <button type="submit" class="btn btn-success">Guardar</button>
      <a href="{{ url_for('usuarios.index') }}" class="btn btn-secondary">Volver</a>
    </div>
  </form>
</div>
{% include 'includes/footer.html' %}
